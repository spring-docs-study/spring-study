# 스프링 부트와 스프링 MVC 이해

## 7.1 웹앱이란
 - 웹 브라우저로 접속하는 모든 앱

> 그림 7-1
> ![그림 7-1.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-1.jpg)
> 시대의 변화로 거의 모든 앱이 웹앱이다.

### 7.1.1 웹앱에 대한 일반적인 개요

- 웹앱은 두 부분으로 구성된다.
  - 클라이언트 측 : 사용자가 직접 상호 작용하는 부분이다. 웹 앱의 클라이언트 측을 대표하는 웹 브라우저는 웹 서버에 요청을 보내고, 서버에서 응답을 수신하며, 사용자가 앱과 상호 작용할 수 있는 방법을 제공한다. 웹 앱의 클라이언트 축을 프런트엔드 라고도 한다.
    - 클라이언트는 컴퓨터, 휴대폰, 태블릿 등 다양하게 웹 브라우저를 사용한다.

  - 서버 측 : 클라이언트에서 요청을 수신하고 응답에 데이터를 회신한다. 서버측은 응답을 보내기 전에 클라이언트가 요청한 데이터를 처리하고, 때로는 저장하는 로직을 구현한다. 웹 앱의 서버 측을 백엔드라고도 한다.
    - 백엔드는 동시에 여러 클라이언트에 서비스를 제공할 수 있다.

> 그림 7-2
> ![그림 7-2.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-2.jpg)

> 그림 7-3
> ![그림 7-3.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-3.jpg)

### 7.1.2 스프링으로 웹 앱을 구현하는 다양한 방식

웹 어플리케이션 구현하는데 사용할 수 있는 두 가지 주요 설계 방법
1. 클라이언트 요청에 응답하여 백엔드가 완성된 뷰를 제공하는 앱 : 웹 브라우저는 백엔드에서 받은 데이터를 직접 해석하여 이 앱을 통해 사용자에게 이 정보를 표시한다.
2. 프런트엔드-백엔드 분리방식의 앱 : 이런 앱의 경우 백엔드는 원시 데이터만 제공한다. 웹 브라우저는 백엔드 응답에 있는 데이터를 표시하지 않는다. 웹 브라우저는 백엔드 응답을 가져와 데이터를 처리하고 웹 브라우저에 표시할 내용을 지시하는 별도의 프런트엔드 앱을 실행한다.


> 그림 7-4 첫 번째 설계 방법
> ![그림 7-4.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-4.jpg)
> - 이런 앱에서는 거의 모든 일을 백엔드쪽에서 발생한다.백엔드는 사용자 동작을 나타내는 요청을 받고 일부 로직을 실행한다.
> - 최종적으로 서버는 웹 브라우저에 표시해야 할 내용으로 응답한다.
> - 백엔드는 HTML, CSS, 이미지 등 웹 브러우저가 해석하고 표시할 수 있는 형식의 데이터로 응답한다.
> - 또한 백엔드는 웹 브라우저가 이해하고 실행할 수 있는 언어(자바스크립트)로 작성된 스크립트를 전송할 수도 있다.


> 그림 7-5 두 번째 설계 방법
> ![그림 7-5.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-5.jpg)
> - 원시 데이터만 전송한다.
> - 웹 브라우저는 서버의 초기 요청에 로드하는 독립적인 프런트엔드 앱을 실행한다.
> - 이 프런트엔드 앱은 서버의 원시 응답을 가져와서 해석하고 정보 표시 방식을 결정한다.


프로덕션 앱에서 이 두 가지 방식을 모두 발견할 수 있다.
- 프런트엔드-백엔드 분리방식의 앱
  - 최신방식
  - 대규모 앱 개발을 더 쉽게 관리할 수 있다.
  - 여러 팀이 프론트엔드와 백엔드 구현을 담당한다면 더 많은 개발자가 협업하여 앱을 개발할 수 있다.
  - 프런트엔드와 백엔드 배포를 독립적으로 관리할 수 있다.

- 클라이언트 요청에 응답하여 백엔드가 완성된 뷰를 제공하는 앱
  - 소규모 앱에 적합하다.


### 7.1.3 웹 앱 개발에서 서블릿 컨테이너 사용

가장 중요하게 고려해야 할 것은 클라이언트와 서버 간 통신이다. 웹 브라우저는 HTTP라는 프로토콜을 사용하여 네트워크를 통해 서버와 통신한다. 클라이언트가 서버에 요청을 보내면 서버가 응답한다. 클라이언트는 요청을 보낼 때마다 응답을 기다린다.
실제로는 HTTP를 이해하고 HTTP 요청과 응답을 자바 앱으로 변환하는 것이 필요하다.
이것이 웹 서버라고 하는 서블릿 컨테이너이며, 자바 앱의 HTTP 메세지를 변환하는 역할을 한다.
가장 널리 알려진 구현체 중 하나는 이 책 예제에서 사용할 의존성이기도 한 톰캣 이다.

---

Apache Tomcat은 오픈 소스 서블릿 컨테이너로, 자바 서블릿과 JSP(JavaServer Pages)를 실행할 수 있는 웹 서버입니다. Tomcat은 웹 애플리케이션을 호스팅하고, 클라이언트의 HTTP 요청을 처리하며, 자바 기반의 웹 애플리케이션을 개발하고 배포하는 데 주로 사용됩니다.

- 주요 기능과 특징
  - 서블릿과 JSP 지원
  - 웹 애플리케이션 배포
  - HTTP 서버 기능
  - 컨텍스트 관리
  - 세션 관리
  - 보안 기능
  - 클러스터링 및 로드 밸런싱
  - 플러그인 및 확장성

---

다음 그림은 앱 아키텍처에서 서블릿 컨테이너를 시각적으로 표현한 것이다.

- 서블릿이란 서블릿 컨테이너와 직접 상호 작용하는 자바 객체에 불과하다. 서블릿 컨테이너는 HTTP 요청을 받으면 서블릿 객체의 메서드를 호출하고 그 요청을 매개변수로 제공한다. 또 동일한 메서드는 요청한 클라이언트에 반환할 응답을 설정하기 위해 서블릿에서 사용되는 HTTP 응답을 나타내는 매개변수도 가져온다.


웹 애플리케이션 개발에서 서블릿 컨테이너는 중요한 역할을 합니다. 서블릿 컨테이너(Servlet Container)란 서블릿(Servlet)과 JSP(JavaServer Pages)를 실행하고 웹 서버와의 통신을 처리하는 서버 측 컴포넌트입니다. 이를 통해 Java 기반의 웹 애플리케이션을 쉽게 개발하고 배포할 수 있습니다.

  - 주요 기능
    - 서블릿 관리 
      - 서블릿 컨테이너는 서블릿 클래스의 인스턴스를 생성하고 관리합니다. 클라이언트 요청이 있을 때 서블릿을 로드하고 초기화하며, 필요에 따라 인스턴스를 재사용하거나 새로운 인스턴스를 생성합니다.
    - 요청 및 응답 처리 
      - 서블릿 컨테이너는 클라이언트로부터 HTTP 요청을 받아 서블릿으로 전달하고, 서블릿에서 처리된 결과를 클라이언트에게 HTTP 응답으로 돌려줍니다. 이 과정에서 HTTP 요청 및 응답 객체(HttpServletRequest 및 HttpServletResponse)를 생성하고 관리합니다.
    - 세션 관리 
      - 서블릿 컨테이너는 클라이언트와의 세션을 관리합니다. 클라이언트의 상태를 유지하기 위해 쿠키나 URL 재작성 등을 사용하여 세션을 추적합니다.
    - 안전성 및 보안 관리 
      - 서블릿 컨테이너는 SSL을 통한 보안 통신, 인증 및 권한 부여 등의 보안 기능을 지원합니다. 이를 통해 웹 애플리케이션의 안전성을 높일 수 있습니다.
    - 멀티스레딩 
      - 서블릿 컨테이너는 다중 스레드를 이용해 여러 클라이언트 요청을 동시에 처리할 수 있습니다. 이를 통해 웹 애플리케이션의 성능을 향상시킵니다.
    - 라이프사이클 관리 
      - 서블릿의 생명주기(lifecycle)를 관리합니다. 서블릿의 생성, 초기화, 요청 처리, 종료 등의 과정을 컨테이너가 자동으로 처리합니다.

               

  - 서블릿 컨테이너의 종류

    - Apache Tomcat
      - 가장 많이 사용되는 오픈 소스 서블릿 컨테이너 중 하나입니다. Tomcat은 서블릿과 JSP를 실행할 수 있는 완전한 웹 서버 기능을 제공합니다.
    - Jetty
      - 경량의 서블릿 컨테이너로, 임베디드 모드에서 사용하기에 적합합니다.
    - GlassFish
      - Oracle에서 제공하는 자바 EE 플랫폼을 위한 애플리케이션 서버로, 서블릿 컨테이너 기능도 포함하고 있습니다.
    - WildFly (이전의 JBoss AS)
      - Red Hat에서 제공하는 오픈 소스 애플리케이션 서버로, 서블릿 컨테이너를 포함합니다.

> 서블릿 컨테이너 흐름
> ![서블릿 컨테이너 흐름.png](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\서블릿 컨테이너 흐름.png)



## 다이어그램 설명

1. Client: 웹 브라우저 또는 HTTP 클라이언트가 서버로 HTTP 요청을 보냅니다.
2. Web Server: Apache HTTP Server 또는 Nginx와 같은 웹 서버가 HTTP 요청을 수신합니다. (Tomcat 자체도 웹 서버 역할을 할 수 있습니다.)
3. Servlet Container (e.g., Tomcat, Jetty): 서블릿 컨테이너는 여러 구성 요소로 이루어져 있습니다.
   • Catalina: 서블릿의 생명주기를 관리합니다. 서블릿을 생성하고 초기화하며 요청을 처리하고 소멸시킵니다.
   • Coyote: HTTP 커넥터로, 클라이언트와의 HTTP 통신을 처리합니다.
   • Jasper: JSP 엔진으로, JSP 파일을 서블릿으로 변환하고 실행합니다.
4. Servlets & JSPs: 동적 웹 콘텐츠를 생성하는 자바 클래스와 JSP 파일입니다.
5. 응답 반환: 처리된 결과를 클라이언트에게 HTML, JSON, XML 등의 형식으로 응답합니다.


## 요청과 응답 흐름

1. 클라이언트 요청: 클라이언트가 웹 서버로 HTTP 요청을 보냅니다.
2. 웹 서버: HTTP 요청을 서블릿 컨테이너로 전달합니다.
3. 서블릿 컨테이너:
   • 요청을 분석하고 적절한 서블릿이나 JSP로 전달합니다.
   • Catalina가 서블릿의 생명주기를 관리하며 요청을 처리합니다.
   • Coyote가 HTTP 요청과 응답을 처리합니다.
   • Jasper가 JSP 파일을 서블릿으로 변환하여 실행합니다.
> ![그림 7-6.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-6.jpg)
4. 동적 콘텐츠 생성: 서블릿이나 JSP가 요청을 처리하고 동적 콘텐츠를 생성합니다.
> ![그림 7-7.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-7.jpg)
> ![그림 7-8.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 4회\그림 7-8.jpg)
5. 응답 반환: 생성된 콘텐츠가 웹 서버를 통해 클라이언트에게 응답됩니다.


## 7.2 스프링 부트의 마법

Spring Boot란 
  - 스프링 프레임워크의 서브 프로젝트로, 스프링 애플리케이션을 쉽게 만들고 배포할 수 있도록 도와주는 다양한 기능을 제공합니다. Spring Boot는 설정을 간소화하고, 생산성을 높이며, 개발자 경험을 향상시키는 것을 목표로 합니다.


스프링 부트 기능과 해당 기능이 제공하는 이점
- 간소화된 프로젝트 생성
  - 프로젝트 초기화 서비스를 이용하여 비어 있지만 구성된 뼈대 앱을 얻을 수 있다.
- 의존성 스타터
  - 스프링 부트는 특정 목적에 사용되는 특정 의존성들을 의존성 스타터로 모았다. 특정 목적을 위해 프로젝트에 추가해야 하는 모든 필수 의존성을 파악하거나 호환성으ㅜㄹ 위해 어떤 버전을 사용해야 하는지 파악할 필요가 없다.
- 의존성에 기반을 둔 자동 구성
  - 프로젝트에 추가한 의존성에 따라 스프링 부트에서 제공하는 구성 중에서 필요한 구성과 다른 것만 변경하면 된다. 구성을 변경만 한다면 모두 새로 작성하는 것보다 더 적은 코드가 필요할 것이다.


## 7.2.1 프로젝트 초기화 서비스를 이용한 스프링 부트 프로젝트 생성


## 7.4 요약

- 웹 앱은 사용자가 웹 브라우저를 사용하여 상호 작용하는 애플리케이션이다. 웹 앱에는 데이터가 처리되고 저장되는 클라이언트 측과 서버 측이 있다. 클라이언트 측은 서버측에 요청을 보낸다.
백엔드는 프런트엔드에서 요청한 작업을 실행하고 응답한다.
- 스프링은 웹 앱을 구현할 수 있는 기능을 제공한다. 많은 구성을 작성하지 않으려면 스프링 부트를 사용할 수 있다. 스프링 에코 시스템 프로젝트인 스프링 부트는 구성보다 관례 원칙을 적용해서 앱에 필요한 기능에 대한 기본 구성을 제공한다.
- 스프링 부트에서 제공하는 여러 의존성 스타터로 의존성을 더 쉽게 구성할 수도 있다.의존성 스타터는 앱에 특정 기능을 재공하고자 호환 가능한 버전들로 구성된 의존성 그룹이다.
- HTTP 요청을 받고 응답을 전달하기 위해 자바 백엔드 웹 앱에는 HTTP 요청과 응답을 자바 앱으로 변환하는 기능이 있는 소프트웨어인 서블릿 컨테이너가 필요하다. 서블릿 컨테이너를 사용하면 HTTP 프로토콜로 네트워크를 통한 통신을 구현할 필요가 없다.
- 서블릿 컨테이너를 자동으로 구성하고 웹 앱의 사용 사례를 작성하는 데 필요한 기능을 제공하는 스프링 부트 프로젝트로 쉽게 웹 앱 프로젝트를 만들 수 있다. 또 스프링 부트는 HTTP 요청을 가로채고 관리하는 컴포넌트 집합을 구성한다. 이 컴포넌트들은 스프링 MVC 라고 하는 클래스 설계의 일부다.
- 스프링 부트는 스프링 MVC 컴포넌트와 서블릿 컨테이너를 자동 구성하기 때문에 앱이 응답으로 보내는 데이터를 포함하는  HTML 문서와 최소한의 HTTP 요청-응답 흐름 작업을 위한 컨트롤러 클래스만 작성하면 된다.
- 애너테이션을 사용하여 컨트롤러와 컨트롤러의 액션을 구성한다. 클래스를 스프링 MVC 컨트롤러로 표사하려면 @Controller 스테레오타입 애너테이션을 사용하며, 특정 HTTP 요청에 컨트롤러 액션을 할당하려면 @RequestMapping 애너테이션을 사용한다.











