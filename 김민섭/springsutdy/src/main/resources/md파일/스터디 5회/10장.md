# 10장 REST 서비스 구현

REST 서비스는 Representational State Transfer(REST) 아키텍처 스타일을 따르는 웹 서비스를 의미합니다. REST는 웹 서비스와 웹 애플리케이션을 설계하기 위한 가이드라인 및 패턴 모음을 제공합니다. RESTful 웹 서비스는 클라이언트와 서버 간의 통신을 위한 인터페이스를 정의하며, HTTP 프로토콜을 기반으로 동작합니다.

REST 서비스는 두 앱 간 통신을 구현하는 데 가장 자주 접하는 방법 중 하나로, 클라이언트가 호출할 수 있는 엔드포인트를 이용하여 서버가 노출하는 기능에 액세스할 수 있게 해 준다.

웹 앱에서는 REST 서비스를 이용하여 클라이언트와 서버 간 통신을 설정하지만 모바일 앱과 백엔드, 두 백엔드 서비스 간 통신을 개발하는 데 REST 서비스를 이용할 수 있다.

> 그림 10-1 
> ![그림 10-1.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 5회\그림 10-1.jpg)


REST의 주요 특징
   - 클라이언트-서버 구조: 클라이언트와 서버는 명확히 분리되어 있어, 클라이언트는 사용자 인터페이스와 관련된 작업을 수행하고, 서버는 데이터 저장 및 비즈니스 로직을 처리합니다.
   
   - 무상태성: 각 요청은 독립적이고, 이전 요청의 상태를 저장하지 않습니다. 즉, 서버는 클라이언트의 상태를 기억하지 않으며, 각 요청에는 필요한 모든 정보가 포함되어야 합니다.
   
   - 캐시 가능성: 응답은 명시적으로 캐시 가능하거나 불가능해야 하며, 캐시를 활용하여 성능을 향상시킬 수 있습니다.
   
   - 계층화 시스템: 클라이언트는 직접 서버와 통신하는 것이 아니라 중간 서버(예: 프록시, 게이트웨이 등)를 통해 통신할 수 있습니다. 이는 확장성과 보안을 향상시킵니다.
   
   - 인터페이스의 통일성: REST는 일관된 인터페이스를 제공하여 각 구성 요소 간의 상호 작용을 단순화하고 분리합니다. 주로 HTTP 메서드(예: GET, POST, PUT, DELETE)를 사용하여 자원을 조작합니다.
   
   - 자원 기반: 모든 것은 자원(Resource)으로 간주됩니다. 자원은 URI(Uniform Resource Identifier)를 통해 고유하게 식별되며, 클라이언트는 URI를 통해 자원에 접근합니다.


## 10.1 REST 서비스를 이용한 앱 간 데이터 교환
 - REST 서비스와 스프링이 스프링 MVC 구현을 어떻게 지원하는지 설명한다.
   - REST 엔드포인트는 단순히 두 앱 간 통신을 구현하는 방법이며, HTTP 메서드와 경로에 매핑된 컨트롤러 액션을 구현하는 것만큼이나 간단하다.
   - 앱은 HTTP 로 이 컨트롤러 액션을 호출한다.
   - 앱은 웹 프로토콜로 서비스를 노출하는 방식을 따르기 때문에 우리는 이 엔드포인트를 웹 서비스ㅎ라고 한다.
   - 스프링에서 REST 엔드포인트는 HTTP 메서드와 경로에 매핑된 컨트롤러 액션이다.
   - 스프링은 웹 앱에서 배운 것과 동일한 메커니즘을 사용하여 REST 엔드포인트를 노출한다.
   - REST 서비스가 다른 점은 스프링 MVC 디스패치 서블릿이 뷰를 찾지 않는다는 것이다.
   - 따라서 스프링 MVC 다이어그램에서 뷰 리졸버가 없어진다.
   - 서버는 컨트롤러의 액션이 반환하는 것을 클라이언트에 대한 HTTP 응답으로 직접 전송한다.


>그림 10-2 REST 엔드포인트를 구현할 때 MVC 흐름도
> ![그림 10-2.jpg](\김민섭\springsutdy\src\main\resources\md파일\스터디 5회\그림 10-2.jpg)


 - REST 엔드포인트에 수반될 수 있는 몇 가지 통신 문제
   1. 컨트롤러 작업이 완료되는 데 오랜 시간이 소요된다면 엔드포인트에 대한 HTTP 호출이 타임아웃 되어 통신이 중단될 수 있다.
   2. HTTP 요청으로 한 번의 호출에 대량의 데이터를 전송하면 호출이 타임아웃되어 통신이 중단될 수 있다. REST 호출로 수 메가바이트 이상을 전송하는 것은 일반적으로 올바른 결정이 아니다.
   3. 백엔드 컴포넌트로 노출된 엔드포인트에 대한 동시 호출이 과도하면 앱은 지나치게 많은 부하를 받아 실패할 수 있다.
   4. 네트워크는 HTTP 호출을 지원하지만 네트워크가 100% 신뢰할 수 있는 것은 아니다. 네트워크 때문에 REST 엔드포인트 호출이 실패할 가능성은 항상 존재한다.

## 10.3 HTTP 응답 관리

컨트롤러의 액션에서 HTTP 응답을 관리하는 방법
 - HTTP 응답은 클라이언트 요청에 따라 백엔드 앱이 클라이언트에 데이터를 재전송하는 방식이다.
   - 응답 헤더 : 응답에 포함된 작은 데이터 조각이다.
   - 응답 본문 : 백엔드에서 응답으로 보내야 하는 많은 양의 데이터이다.
   - 응답 상태 : 요청 결과를 간략하게 표현하는 내용이다.

응답 상태 및 헤더 설정
 - 기본적으로 스프링은 다음과 같은 몇 가지 공통적인 HTTP 상태를 설정한다.
   - 200 OK : 요청을 처리하는 동안 서버 측에서 예외가 발생하지 않은 경우다.
   - 404 Not Found : 요청된 리소스가 존재하지 않는 경우다.
   - 400 Bad Request : 요청 일부가 서버가 예상한 방식과 일치하지 않는 경우다.
   - 500 Error on server : 요청을 처리하는 동안 어떤 이유로 서버측에서 예외가 발생한 경우다. 이런 종류의 예외는 백엔드에서 문제를 해결한다.

## 10.5 요약

 - REST 웹 서비스는 두 애플리케이션 간 통신을 설정하는 간단한 방법이다.
 - 스프링 앱에서 스프링 MVC 메커니즘은 REST 엔드포인트 구현을 지원한다. 메서드가 응답 본문을 직접 반환하도록 지정하려면 @ResponseBody 애너테이션을 사용하거나, REST 엔드포인트를 구현하기 위해 @Controller 애너테이션을 @RestController 로 대체해야 할 필요가 있다.
 - 컨트롤러 액션이 HTTP 응답 본문을 직접 반환하게 만들면, HTTP 상태 설정은 스프링의 기본 동작에 의존한다.
 - 컨트롤러 액션이 ResponseEntity 인스턴스를 반환하게 만들면 HTTP 상태 및 헤더를 모두 관리할 수 있다.
 - 예외를 관리하는 한 가지 방법은 컨트롤러의 액션 수준에서 직접 예외를 처리하는 것이다. 이렇게 하면 예외를 처리하는데 사용되는 로직이 특정 컨트롤러 액션과 결합되어 코드 중복이 발생할 수 ㅇ맀는데, 이는 가장 피해야 할 일이다.
 - 컨트롤러 액션의 예외를 직접 관리하거나 컨트롤러 액션이 예외를 방생하는 경우 예외 실행 로직을 REST컨트롤러 어드바이스 클래스를 사용하여 분리할 수 있다.
 - 엔그포인트는 HTTP 요청의 요청 매개변수, 경로 변수, HTTP 요청 본문을 통해 클라이언트에서 데이터ㅡㄹ 가져올 수 있다.


































